<!DOCTYPE HTML>
<html lang="en" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ArmCapability Schema - OctoLLM Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Distributed AI Architecture for Offensive Security and Developer Tooling - Comprehensive technical documentation covering architecture, API, development, operations, and security.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OctoLLM Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/doublegate/OctoLLM" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/doublegate/OctoLLM/edit/main/docs/src/api/schemas/arm-capability.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="armcapability-schema-reference"><a class="header" href="#armcapability-schema-reference">ArmCapability Schema Reference</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>The <strong>ArmCapability</strong> schema defines how specialized arms register their capabilities with the Orchestrator. This registry enables dynamic task routing, cost-aware scheduling, and capability-based delegation across the OctoLLM system.</p>
<p><strong>Used By</strong>: Orchestrator (for arm registry), all Arms (for self-registration)
<strong>Primary Endpoint</strong>: <code>GET /capabilities</code>
<strong>Format</strong>: JSON</p>
<hr />
<h2 id="structure"><a class="header" href="#structure">Structure</a></h2>
<h3 id="armcapability"><a class="header" href="#armcapability">ArmCapability</a></h3>
<p>Complete arm registration structure returned by the capabilities endpoint.</p>
<pre><code class="language-typescript">interface ArmCapability {
  arm_id: string;                  // Required: Unique arm identifier
  name: string;                    // Required: Human-readable name
  description: string;             // Required: Purpose and specialization
  capabilities: string[];          // Required: Capability tags
  cost_tier: number;               // Required: 1-5 (1=cheap, 5=expensive)
  endpoint: string;                // Required: Service URL
  status?: ArmStatus;              // Optional: Current health status
  input_schema?: JSONSchema;       // Optional: Request schema
  output_schema?: JSONSchema;      // Optional: Response schema
  metadata?: ArmMetadata;          // Optional: Additional info
}

type ArmStatus = 'healthy' | 'degraded' | 'unavailable';

interface ArmMetadata {
  version?: string;                // Arm version (e.g., "0.3.0")
  technology?: string;             // Tech stack (e.g., "Python/FastAPI")
  model?: string;                  // LLM model if applicable
  average_latency_ms?: number;     // Typical response time
  max_concurrent_tasks?: number;   // Concurrency limit
  uptime_percentage?: number;      // 30-day uptime (0-100)
}
</code></pre>
<hr />
<h2 id="field-definitions"><a class="header" href="#field-definitions">Field Definitions</a></h2>
<h3 id="arm_id-required"><a class="header" href="#arm_id-required"><code>arm_id</code> (required)</a></h3>
<p><strong>Type</strong>: string
<strong>Constraints</strong>: Lowercase, alphanumeric with hyphens
<strong>Description</strong>: Unique identifier used for arm routing and discovery</p>
<p><strong>Valid Arm IDs</strong> (current system):</p>
<pre><code class="language-typescript">type ArmId =
  | 'planner'
  | 'executor'
  | 'retriever'
  | 'coder'
  | 'judge'
  | 'safety-guardian';
</code></pre>
<p><strong>Validation</strong>:</p>
<pre><code class="language-typescript">function validateArmId(armId: string): boolean {
  const pattern = /^[a-z0-9]+(-[a-z0-9]+)*$/;
  if (!pattern.test(armId)) {
    throw new Error("arm_id must be lowercase alphanumeric with hyphens");
  }
  return true;
}
</code></pre>
<hr />
<h3 id="name-required"><a class="header" href="#name-required"><code>name</code> (required)</a></h3>
<p><strong>Type</strong>: string
<strong>Constraints</strong>: 3-50 characters
<strong>Description</strong>: Human-readable display name for the arm</p>
<p><strong>Examples</strong>:</p>
<pre><code class="language-json">"Planner Arm"
"Tool Executor Arm"
"Code Generation Arm"
"Safety Guardian Arm"
</code></pre>
<hr />
<h3 id="description-required"><a class="header" href="#description-required"><code>description</code> (required)</a></h3>
<p><strong>Type</strong>: string
<strong>Constraints</strong>: 10-200 characters
<strong>Description</strong>: Concise explanation of the arm's purpose and specialization</p>
<p><strong>Best Practices</strong>:</p>
<ul>
<li>Start with the primary function</li>
<li>Mention key specializations</li>
<li>Keep under 200 characters</li>
</ul>
<p><strong>Examples</strong>:</p>
<pre><code class="language-json">"Task decomposition and planning specialist"
"Sandboxed command execution specialist with capability-based security"
"Hybrid vector and keyword search over knowledge bases"
"Code generation, debugging, and refactoring using GPT-4"
</code></pre>
<hr />
<h3 id="capabilities-required"><a class="header" href="#capabilities-required"><code>capabilities</code> (required)</a></h3>
<p><strong>Type</strong>: array of strings
<strong>Constraints</strong>: At least 1 capability tag
<strong>Description</strong>: Tags describing what the arm can do, used for task routing</p>
<h4 id="capability-tag-taxonomy"><a class="header" href="#capability-tag-taxonomy">Capability Tag Taxonomy</a></h4>
<p><strong>Planning Capabilities</strong>:</p>
<ul>
<li><code>task_planning</code> - Task decomposition into subtasks</li>
<li><code>goal_decomposition</code> - Breaking down high-level goals</li>
<li><code>dependency_resolution</code> - Managing task dependencies</li>
<li><code>acceptance_criteria</code> - Defining success conditions</li>
</ul>
<p><strong>Execution Capabilities</strong>:</p>
<ul>
<li><code>shell_execution</code> - Running shell commands</li>
<li><code>http_requests</code> - Making HTTP/HTTPS requests</li>
<li><code>python_execution</code> - Running Python scripts</li>
<li><code>network_scanning</code> - Port scanning and network recon</li>
</ul>
<p><strong>Knowledge Capabilities</strong>:</p>
<ul>
<li><code>vector_search</code> - Semantic similarity search</li>
<li><code>keyword_search</code> - Traditional keyword-based search</li>
<li><code>rag_retrieval</code> - Retrieval-Augmented Generation</li>
<li><code>citation_generation</code> - Creating source citations</li>
</ul>
<p><strong>Code Capabilities</strong>:</p>
<ul>
<li><code>code_generation</code> - Creating new code</li>
<li><code>code_debugging</code> - Finding and fixing bugs</li>
<li><code>code_refactoring</code> - Improving code structure</li>
<li><code>code_analysis</code> - Understanding existing code</li>
<li><code>test_generation</code> - Creating unit tests</li>
<li><code>code_explanation</code> - Documenting code</li>
</ul>
<p><strong>Validation Capabilities</strong>:</p>
<ul>
<li><code>schema_validation</code> - Validating data structures</li>
<li><code>fact_checking</code> - Verifying factual claims</li>
<li><code>criteria_validation</code> - Checking acceptance criteria</li>
<li><code>hallucination_detection</code> - Identifying LLM hallucinations</li>
<li><code>quality_assessment</code> - Evaluating output quality</li>
</ul>
<p><strong>Safety Capabilities</strong>:</p>
<ul>
<li><code>pii_detection</code> - Finding personally identifiable information</li>
<li><code>secret_detection</code> - Identifying API keys, passwords, tokens</li>
<li><code>content_filtering</code> - Blocking inappropriate content</li>
<li><code>input_sanitization</code> - Cleaning user input</li>
<li><code>output_redaction</code> - Removing sensitive data</li>
</ul>
<p><strong>Example Capability Sets</strong>:</p>
<pre><code class="language-json">// Planner Arm
{
  "capabilities": [
    "task_planning",
    "goal_decomposition",
    "dependency_resolution",
    "acceptance_criteria"
  ]
}

// Executor Arm
{
  "capabilities": [
    "shell_execution",
    "http_requests",
    "python_execution",
    "network_scanning"
  ]
}

// Coder Arm
{
  "capabilities": [
    "code_generation",
    "code_debugging",
    "code_refactoring",
    "code_analysis",
    "test_generation",
    "code_explanation"
  ]
}
</code></pre>
<hr />
<h3 id="cost_tier-required"><a class="header" href="#cost_tier-required"><code>cost_tier</code> (required)</a></h3>
<p><strong>Type</strong>: integer
<strong>Constraints</strong>: 1-5
<strong>Description</strong>: Relative cost indicator for resource-aware scheduling</p>
<h4 id="cost-tier-definitions"><a class="header" href="#cost-tier-definitions">Cost Tier Definitions</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Tier</th><th>Name</th><th>Characteristics</th><th>LLM Usage</th><th>Typical Cost/Task</th></tr></thead><tbody>
<tr><td><strong>1</strong></td><td>Cheap</td><td>No LLM calls, pure computation</td><td>None</td><td>$0.00</td></tr>
<tr><td><strong>2</strong></td><td>Low</td><td>Small model, simple tasks</td><td>GPT-3.5-turbo</td><td>$0.01-0.05</td></tr>
<tr><td><strong>3</strong></td><td>Medium</td><td>Medium model or sandboxing overhead</td><td>GPT-3.5-turbo (complex)</td><td>$0.05-0.10</td></tr>
<tr><td><strong>4</strong></td><td>High</td><td>Large model, complex tasks</td><td>GPT-4</td><td>$0.10-0.50</td></tr>
<tr><td><strong>5</strong></td><td>Expensive</td><td>Frontier model, multi-step reasoning</td><td>GPT-4/Claude Opus</td><td>$0.50-2.00</td></tr>
</tbody></table>
</div>
<h4 id="cost-tier-examples"><a class="header" href="#cost-tier-examples">Cost Tier Examples</a></h4>
<p><strong>Tier 1 - Cheap</strong>:</p>
<pre><code class="language-json">{
  "arm_id": "reflex-layer",
  "cost_tier": 1,
  "rationale": "Cache lookups and regex pattern matching only"
}

{
  "arm_id": "safety-guardian",
  "cost_tier": 1,
  "rationale": "Regex-based PII/secret detection without LLM"
}
</code></pre>
<p><strong>Tier 2 - Low</strong>:</p>
<pre><code class="language-json">{
  "arm_id": "planner",
  "cost_tier": 2,
  "rationale": "GPT-3.5-turbo for task decomposition (500-2000 tokens)"
}

{
  "arm_id": "judge",
  "cost_tier": 2,
  "rationale": "GPT-3.5-turbo for validation (1000-3000 tokens)"
}
</code></pre>
<p><strong>Tier 3 - Medium</strong>:</p>
<pre><code class="language-json">{
  "arm_id": "executor",
  "cost_tier": 3,
  "rationale": "Docker sandboxing overhead, no LLM but resource-intensive"
}

{
  "arm_id": "retriever",
  "cost_tier": 3,
  "rationale": "Vector database queries and embedding generation"
}
</code></pre>
<p><strong>Tier 4 - High</strong>:</p>
<pre><code class="language-json">{
  "arm_id": "coder",
  "cost_tier": 4,
  "rationale": "GPT-4 for complex code generation (5000-10000 tokens)"
}
</code></pre>
<p><strong>Tier 5 - Expensive</strong>:</p>
<pre><code class="language-json">{
  "arm_id": "orchestrator",
  "cost_tier": 5,
  "rationale": "GPT-4/Claude Opus with multi-step reasoning and synthesis"
}
</code></pre>
<hr />
<h3 id="endpoint-required"><a class="header" href="#endpoint-required"><code>endpoint</code> (required)</a></h3>
<p><strong>Type</strong>: string (URI format)
<strong>Description</strong>: HTTP(S) URL where the arm service is accessible</p>
<p><strong>Environment-Specific Endpoints</strong>:</p>
<pre><code class="language-typescript">// Local Development (Docker Compose)
const endpoints = {
  planner: "http://planner:8002",
  executor: "http://executor:8003",
  retriever: "http://retriever:8004",
  coder: "http://coder:8005",
  judge: "http://judge:8006",
  safetyGuardian: "http://safety-guardian:8007"
};

// Kubernetes (Internal)
const k8sEndpoints = {
  planner: "http://planner.octollm.svc.cluster.local:8002",
  executor: "http://executor.octollm.svc.cluster.local:8003"
};

// Production (External)
const prodEndpoints = {
  planner: "https://planner.api.octollm.example.com",
  executor: "https://executor.api.octollm.example.com"
};
</code></pre>
<p><strong>Validation</strong>:</p>
<pre><code class="language-typescript">function validateEndpoint(endpoint: string): boolean {
  try {
    const url = new URL(endpoint);
    if (!['http:', 'https:'].includes(url.protocol)) {
      throw new Error("Endpoint must use HTTP or HTTPS protocol");
    }
    return true;
  } catch (error) {
    throw new Error(`Invalid endpoint URL: ${endpoint}`);
  }
}
</code></pre>
<hr />
<h3 id="status-optional"><a class="header" href="#status-optional"><code>status</code> (optional)</a></h3>
<p><strong>Type</strong>: enum
<strong>Values</strong>: <code>'healthy'</code> | <code>'degraded'</code> | <code>'unavailable'</code>
<strong>Description</strong>: Current operational status of the arm</p>
<h4 id="status-definitions"><a class="header" href="#status-definitions">Status Definitions</a></h4>
<p><strong>healthy</strong> - Arm is fully operational</p>
<ul>
<li>All endpoints responding normally</li>
<li>Latency within acceptable range</li>
<li>Error rate &lt;1%</li>
</ul>
<p><strong>degraded</strong> - Arm is partially operational</p>
<ul>
<li>Endpoints responding but slowly</li>
<li>Latency 2-3x normal</li>
<li>Error rate 1-5%</li>
<li>Some features may be disabled</li>
</ul>
<p><strong>unavailable</strong> - Arm is not operational</p>
<ul>
<li>Endpoints not responding</li>
<li>Network connectivity lost</li>
<li>Service crashed or restarting</li>
</ul>
<p><strong>Status Checks</strong>:</p>
<pre><code class="language-python">async def check_arm_status(arm_endpoint: str) -&gt; ArmStatus:
    """Check arm health and return status."""
    try:
        response = await http_client.get(f"{arm_endpoint}/health", timeout=5)

        if response.status_code == 200:
            health_data = response.json()
            latency_ms = response.elapsed.total_seconds() * 1000

            # Check latency thresholds
            if latency_ms &gt; 3000:
                return "degraded"
            return "healthy"
        else:
            return "degraded"

    except Exception as e:
        logger.error(f"Arm {arm_endpoint} health check failed: {e}")
        return "unavailable"
</code></pre>
<hr />
<h3 id="input_schema-optional"><a class="header" href="#input_schema-optional"><code>input_schema</code> (optional)</a></h3>
<p><strong>Type</strong>: JSON Schema object
<strong>Description</strong>: Formal schema defining the arm's expected request format</p>
<p><strong>Example - Planner Arm Input</strong>:</p>
<pre><code class="language-json">{
  "input_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": ["goal"],
    "properties": {
      "goal": {
        "type": "string",
        "minLength": 10,
        "maxLength": 2000
      },
      "constraints": {
        "type": "array",
        "items": {"type": "string"}
      },
      "context": {
        "type": "object",
        "additionalProperties": true
      }
    }
  }
}
</code></pre>
<p><strong>Example - Executor Arm Input</strong>:</p>
<pre><code class="language-json">{
  "input_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": ["action_type", "command", "capability_token"],
    "properties": {
      "action_type": {
        "type": "string",
        "enum": ["shell", "http", "python"]
      },
      "command": {
        "type": "string"
      },
      "args": {
        "type": "array",
        "items": {"type": "string"}
      },
      "timeout_seconds": {
        "type": "integer",
        "minimum": 1,
        "maximum": 300,
        "default": 30
      },
      "capability_token": {
        "type": "string",
        "pattern": "^tok_[a-zA-Z0-9]{16}$"
      }
    }
  }
}
</code></pre>
<hr />
<h3 id="output_schema-optional"><a class="header" href="#output_schema-optional"><code>output_schema</code> (optional)</a></h3>
<p><strong>Type</strong>: JSON Schema object
<strong>Description</strong>: Formal schema defining the arm's response format</p>
<p><strong>Example - Judge Arm Output</strong>:</p>
<pre><code class="language-json">{
  "output_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": ["valid", "confidence", "issues"],
    "properties": {
      "valid": {
        "type": "boolean"
      },
      "confidence": {
        "type": "number",
        "minimum": 0.0,
        "maximum": 1.0
      },
      "issues": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["severity", "type", "message"],
          "properties": {
            "severity": {
              "type": "string",
              "enum": ["error", "warning", "info"]
            },
            "type": {
              "type": "string"
            },
            "message": {
              "type": "string"
            }
          }
        }
      }
    }
  }
}
</code></pre>
<hr />
<h3 id="metadata-optional"><a class="header" href="#metadata-optional"><code>metadata</code> (optional)</a></h3>
<p><strong>Type</strong>: object
<strong>Description</strong>: Additional metadata about the arm's capabilities and performance</p>
<p><strong>Common Metadata Fields</strong>:</p>
<ul>
<li><code>version</code>: Arm version (semantic versioning)</li>
<li><code>technology</code>: Tech stack (e.g., "Python 3.11/FastAPI", "Rust 1.75/Axum")</li>
<li><code>model</code>: LLM model if applicable (e.g., "gpt-4", "gpt-3.5-turbo")</li>
<li><code>average_latency_ms</code>: Typical response time</li>
<li><code>max_concurrent_tasks</code>: Maximum parallel task capacity</li>
<li><code>uptime_percentage</code>: 30-day uptime (0-100)</li>
</ul>
<p><strong>Example</strong>:</p>
<pre><code class="language-json">{
  "metadata": {
    "version": "0.3.0",
    "technology": "Python 3.11 / FastAPI 0.104",
    "model": "gpt-4",
    "average_latency_ms": 8500,
    "max_concurrent_tasks": 10,
    "uptime_percentage": 99.7
  }
}
</code></pre>
<hr />
<h2 id="complete-examples"><a class="header" href="#complete-examples">Complete Examples</a></h2>
<h3 id="example-1-planner-arm"><a class="header" href="#example-1-planner-arm">Example 1: Planner Arm</a></h3>
<pre><code class="language-json">{
  "arm_id": "planner",
  "name": "Planner Arm",
  "description": "Task decomposition and planning specialist",
  "capabilities": [
    "task_planning",
    "goal_decomposition",
    "dependency_resolution",
    "acceptance_criteria"
  ],
  "cost_tier": 2,
  "endpoint": "http://planner:8002",
  "status": "healthy",
  "input_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": ["goal"],
    "properties": {
      "goal": {"type": "string", "minLength": 10, "maxLength": 2000},
      "constraints": {"type": "array", "items": {"type": "string"}},
      "context": {"type": "object"}
    }
  },
  "output_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": ["plan_id", "steps"],
    "properties": {
      "plan_id": {"type": "string"},
      "steps": {"type": "array", "items": {"type": "object"}}
    }
  },
  "metadata": {
    "version": "0.3.0",
    "technology": "Python 3.11 / FastAPI",
    "model": "gpt-3.5-turbo",
    "average_latency_ms": 2500,
    "max_concurrent_tasks": 20,
    "uptime_percentage": 99.8
  }
}
</code></pre>
<hr />
<h3 id="example-2-tool-executor-arm"><a class="header" href="#example-2-tool-executor-arm">Example 2: Tool Executor Arm</a></h3>
<pre><code class="language-json">{
  "arm_id": "executor",
  "name": "Tool Executor Arm",
  "description": "Sandboxed command execution specialist",
  "capabilities": [
    "shell_execution",
    "http_requests",
    "python_execution",
    "network_scanning"
  ],
  "cost_tier": 3,
  "endpoint": "http://executor:8003",
  "status": "healthy",
  "input_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": ["action_type", "command", "capability_token"],
    "properties": {
      "action_type": {"type": "string", "enum": ["shell", "http", "python"]},
      "command": {"type": "string"},
      "args": {"type": "array", "items": {"type": "string"}},
      "timeout_seconds": {"type": "integer", "minimum": 1, "maximum": 300},
      "capability_token": {"type": "string"}
    }
  },
  "output_schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": ["success", "provenance"],
    "properties": {
      "success": {"type": "boolean"},
      "stdout": {"type": "string"},
      "stderr": {"type": "string"},
      "exit_code": {"type": "integer"},
      "duration_ms": {"type": "number"},
      "provenance": {"type": "object"}
    }
  },
  "metadata": {
    "version": "0.3.0",
    "technology": "Rust 1.75 / Axum",
    "average_latency_ms": 850,
    "max_concurrent_tasks": 15,
    "uptime_percentage": 99.5
  }
}
</code></pre>
<hr />
<h3 id="example-3-retriever-arm"><a class="header" href="#example-3-retriever-arm">Example 3: Retriever Arm</a></h3>
<pre><code class="language-json">{
  "arm_id": "retriever",
  "name": "Retriever Arm",
  "description": "Hybrid vector and keyword search over knowledge bases",
  "capabilities": [
    "vector_search",
    "keyword_search",
    "rag_retrieval",
    "citation_generation"
  ],
  "cost_tier": 3,
  "endpoint": "http://retriever:8004",
  "status": "healthy",
  "metadata": {
    "version": "0.3.0",
    "technology": "Python 3.11 / FastAPI + Qdrant",
    "average_latency_ms": 1200,
    "max_concurrent_tasks": 25,
    "uptime_percentage": 99.9
  }
}
</code></pre>
<hr />
<h3 id="example-4-coder-arm"><a class="header" href="#example-4-coder-arm">Example 4: Coder Arm</a></h3>
<pre><code class="language-json">{
  "arm_id": "coder",
  "name": "Code Generation Arm",
  "description": "Code generation, debugging, and refactoring using GPT-4",
  "capabilities": [
    "code_generation",
    "code_debugging",
    "code_refactoring",
    "code_analysis",
    "test_generation",
    "code_explanation"
  ],
  "cost_tier": 4,
  "endpoint": "http://coder:8005",
  "status": "healthy",
  "metadata": {
    "version": "0.3.0",
    "technology": "Python 3.11 / FastAPI",
    "model": "gpt-4",
    "average_latency_ms": 8500,
    "max_concurrent_tasks": 10,
    "uptime_percentage": 99.6
  }
}
</code></pre>
<hr />
<h3 id="example-5-judge-arm"><a class="header" href="#example-5-judge-arm">Example 5: Judge Arm</a></h3>
<pre><code class="language-json">{
  "arm_id": "judge",
  "name": "Judge Arm",
  "description": "Multi-layer validation of outputs against criteria and facts",
  "capabilities": [
    "schema_validation",
    "fact_checking",
    "criteria_validation",
    "hallucination_detection",
    "quality_assessment"
  ],
  "cost_tier": 2,
  "endpoint": "http://judge:8006",
  "status": "healthy",
  "metadata": {
    "version": "0.3.0",
    "technology": "Python 3.11 / FastAPI",
    "model": "gpt-3.5-turbo",
    "average_latency_ms": 3200,
    "max_concurrent_tasks": 20,
    "uptime_percentage": 99.7
  }
}
</code></pre>
<hr />
<h3 id="example-6-safety-guardian-arm"><a class="header" href="#example-6-safety-guardian-arm">Example 6: Safety Guardian Arm</a></h3>
<pre><code class="language-json">{
  "arm_id": "safety-guardian",
  "name": "Safety Guardian Arm",
  "description": "PII detection, secret detection, and content filtering",
  "capabilities": [
    "pii_detection",
    "secret_detection",
    "content_filtering",
    "input_sanitization",
    "output_redaction"
  ],
  "cost_tier": 1,
  "endpoint": "http://safety-guardian:8007",
  "status": "healthy",
  "metadata": {
    "version": "0.3.0",
    "technology": "Python 3.11 / FastAPI (regex-based, no LLM)",
    "average_latency_ms": 75,
    "max_concurrent_tasks": 50,
    "uptime_percentage": 99.9
  }
}
</code></pre>
<hr />
<h2 id="usage-patterns"><a class="header" href="#usage-patterns">Usage Patterns</a></h2>
<h3 id="pattern-1-querying-available-capabilities"><a class="header" href="#pattern-1-querying-available-capabilities">Pattern 1: Querying Available Capabilities</a></h3>
<p>Retrieve all registered arms to understand system capabilities.</p>
<pre><code class="language-bash">curl http://orchestrator:8000/capabilities \
  -H "Authorization: Bearer $SERVICE_TOKEN"
</code></pre>
<p><strong>Response</strong>:</p>
<pre><code class="language-json">{
  "arms": [
    {
      "arm_id": "planner",
      "name": "Planner Arm",
      "description": "Task decomposition and planning specialist",
      "capabilities": ["task_planning", "goal_decomposition"],
      "cost_tier": 2,
      "endpoint": "http://planner:8002",
      "status": "healthy"
    },
    {
      "arm_id": "executor",
      "name": "Tool Executor Arm",
      "description": "Sandboxed command execution specialist",
      "capabilities": ["shell_execution", "http_requests", "python_execution"],
      "cost_tier": 3,
      "endpoint": "http://executor:8003",
      "status": "healthy"
    }
  ]
}
</code></pre>
<hr />
<h3 id="pattern-2-capability-based-task-routing"><a class="header" href="#pattern-2-capability-based-task-routing">Pattern 2: Capability-Based Task Routing</a></h3>
<p>Select the appropriate arm based on required capabilities.</p>
<pre><code class="language-typescript">interface TaskRoutingRequest {
  requiredCapabilities: string[];
  preferLowCost?: boolean;
}

async function routeTask(request: TaskRoutingRequest): Promise&lt;ArmCapability&gt; {
  // Fetch all arms
  const response = await fetch('http://orchestrator:8000/capabilities', {
    headers: { 'Authorization': `Bearer ${serviceToken}` }
  });
  const { arms } = await response.json();

  // Filter arms with all required capabilities
  const compatibleArms = arms.filter(arm =&gt;
    request.requiredCapabilities.every(cap =&gt;
      arm.capabilities.includes(cap)
    )
  );

  if (compatibleArms.length === 0) {
    throw new Error(`No arm found with capabilities: ${request.requiredCapabilities}`);
  }

  // Sort by cost tier if preferLowCost is true
  if (request.preferLowCost) {
    compatibleArms.sort((a, b) =&gt; a.cost_tier - b.cost_tier);
  }

  // Return first healthy arm
  const healthyArm = compatibleArms.find(arm =&gt; arm.status === 'healthy');
  if (!healthyArm) {
    throw new Error('No healthy arms available');
  }

  return healthyArm;
}

// Example usage
const arm = await routeTask({
  requiredCapabilities: ['code_generation', 'test_generation'],
  preferLowCost: false
});

console.log(`Routing to: ${arm.name} (cost tier ${arm.cost_tier})`);
// Output: "Routing to: Code Generation Arm (cost tier 4)"
</code></pre>
<hr />
<h3 id="pattern-3-cost-aware-scheduling"><a class="header" href="#pattern-3-cost-aware-scheduling">Pattern 3: Cost-Aware Scheduling</a></h3>
<p>Choose the cheapest arm that meets requirements.</p>
<pre><code class="language-python">from typing import List, Optional

async def schedule_task_cost_aware(
    required_capabilities: List[str],
    max_cost_tier: int = 5
) -&gt; Optional[ArmCapability]:
    """Schedule task to cheapest compatible arm."""

    response = await http_client.get(
        "http://orchestrator:8000/capabilities",
        headers={"Authorization": f"Bearer {service_token}"}
    )
    arms = response.json()["arms"]

    # Filter by capabilities and cost tier
    compatible = [
        arm for arm in arms
        if all(cap in arm["capabilities"] for cap in required_capabilities)
        and arm["cost_tier"] &lt;= max_cost_tier
        and arm["status"] == "healthy"
    ]

    if not compatible:
        return None

    # Sort by cost tier (ascending)
    compatible.sort(key=lambda a: a["cost_tier"])

    cheapest_arm = compatible[0]
    print(f"Scheduled to {cheapest_arm['name']} (tier {cheapest_arm['cost_tier']})")
    return cheapest_arm

# Example usage
arm = await schedule_task_cost_aware(
    required_capabilities=["pii_detection", "secret_detection"],
    max_cost_tier=3
)
# Output: "Scheduled to Safety Guardian Arm (tier 1)"
</code></pre>
<hr />
<h3 id="pattern-4-health-monitoring"><a class="header" href="#pattern-4-health-monitoring">Pattern 4: Health Monitoring</a></h3>
<p>Continuously monitor arm health and adjust routing.</p>
<pre><code class="language-typescript">class ArmHealthMonitor {
  private arms: Map&lt;string, ArmCapability&gt; = new Map();
  private healthCheckInterval = 30000; // 30 seconds

  async start() {
    setInterval(() =&gt; this.refreshCapabilities(), this.healthCheckInterval);
    await this.refreshCapabilities();
  }

  async refreshCapabilities() {
    const response = await fetch('http://orchestrator:8000/capabilities', {
      headers: { 'Authorization': `Bearer ${this.serviceToken}` }
    });
    const { arms } = await response.json();

    for (const arm of arms) {
      this.arms.set(arm.arm_id, arm);

      // Log status changes
      const previous = this.arms.get(arm.arm_id);
      if (previous &amp;&amp; previous.status !== arm.status) {
        console.warn(`Arm ${arm.name} status changed: ${previous.status} → ${arm.status}`);
      }
    }
  }

  getHealthyArms(capability: string): ArmCapability[] {
    return Array.from(this.arms.values()).filter(
      arm =&gt; arm.capabilities.includes(capability) &amp;&amp; arm.status === 'healthy'
    );
  }

  getCheapestHealthyArm(capability: string): ArmCapability | null {
    const healthyArms = this.getHealthyArms(capability);
    if (healthyArms.length === 0) return null;

    return healthyArms.reduce((cheapest, arm) =&gt;
      arm.cost_tier &lt; cheapest.cost_tier ? arm : cheapest
    );
  }
}

// Example usage
const monitor = new ArmHealthMonitor();
await monitor.start();

const arm = monitor.getCheapestHealthyArm('code_generation');
if (arm) {
  console.log(`Using ${arm.name} (${arm.status})`);
} else {
  console.error('No healthy arms available for code generation');
}
</code></pre>
<hr />
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<h3 id="1-always-check-arm-status-before-routing"><a class="header" href="#1-always-check-arm-status-before-routing">1. Always Check Arm Status Before Routing</a></h3>
<p><strong>Why</strong>: Prevents routing to unhealthy arms
<strong>How</strong>: Filter by <code>status: 'healthy'</code> before delegation</p>
<pre><code class="language-typescript">const healthyArms = arms.filter(arm =&gt; arm.status === 'healthy');
</code></pre>
<hr />
<h3 id="2-use-cost-tiers-for-budget-control"><a class="header" href="#2-use-cost-tiers-for-budget-control">2. Use Cost Tiers for Budget Control</a></h3>
<p><strong>Why</strong>: Prevents runaway costs on simple tasks
<strong>How</strong>: Set <code>max_cost_tier</code> constraints</p>
<pre><code class="language-python"># Use cheap arms (tier 1-2) for simple validation
arm = schedule_task(capabilities=["pii_detection"], max_cost_tier=2)

# Allow expensive arms (tier 4-5) for complex reasoning
arm = schedule_task(capabilities=["code_generation"], max_cost_tier=5)
</code></pre>
<hr />
<h3 id="3-capability-tags-should-be-granular"><a class="header" href="#3-capability-tags-should-be-granular">3. Capability Tags Should Be Granular</a></h3>
<p><strong>Why</strong>: Enables precise routing and prevents over-delegation
<strong>How</strong>: Use specific capability tags</p>
<p><strong>Bad</strong> (too broad):</p>
<pre><code class="language-json">{"capabilities": ["coding"]}
</code></pre>
<p><strong>Good</strong> (granular):</p>
<pre><code class="language-json">{
  "capabilities": [
    "code_generation",
    "code_debugging",
    "code_refactoring",
    "test_generation"
  ]
}
</code></pre>
<hr />
<h3 id="4-monitor-arm-health-continuously"><a class="header" href="#4-monitor-arm-health-continuously">4. Monitor Arm Health Continuously</a></h3>
<p><strong>Why</strong>: Enables graceful degradation and failover
<strong>How</strong>: Poll <code>/capabilities</code> endpoint every 30-60 seconds</p>
<pre><code class="language-python">async def monitor_arms():
    while True:
        response = await get_capabilities()
        for arm in response["arms"]:
            if arm["status"] != "healthy":
                logger.warning(f"Arm {arm['name']} is {arm['status']}")
        await asyncio.sleep(30)
</code></pre>
<hr />
<h2 id="related-documentation"><a class="header" href="#related-documentation">Related Documentation</a></h2>
<ul>
<li><a href="../services/orchestrator.html">Orchestrator API Reference</a></li>
<li><a href="./TaskContract.html">TaskContract Schema</a></li>
<li><a href="../../guides/arm-registration.html">Arm Registration Guide</a> (coming soon)</li>
<li><a href="../../guides/cost-optimization.html">Cost Optimization Guide</a> (coming soon)</li>
</ul>
<hr />
<h2 id="json-schema"><a class="header" href="#json-schema">JSON Schema</a></h2>
<p>Complete JSON Schema for validation:</p>
<pre><code class="language-json">{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ArmCapability",
  "type": "object",
  "required": ["arm_id", "name", "description", "capabilities", "cost_tier", "endpoint"],
  "properties": {
    "arm_id": {
      "type": "string",
      "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$",
      "description": "Unique arm identifier (lowercase alphanumeric with hyphens)"
    },
    "name": {
      "type": "string",
      "minLength": 3,
      "maxLength": 50,
      "description": "Human-readable arm name"
    },
    "description": {
      "type": "string",
      "minLength": 10,
      "maxLength": 200,
      "description": "Arm purpose and specialization"
    },
    "capabilities": {
      "type": "array",
      "items": {"type": "string"},
      "minItems": 1,
      "description": "List of capability tags"
    },
    "cost_tier": {
      "type": "integer",
      "minimum": 1,
      "maximum": 5,
      "description": "Cost tier (1=cheap, 5=expensive)"
    },
    "endpoint": {
      "type": "string",
      "format": "uri",
      "description": "Arm service endpoint URL"
    },
    "status": {
      "type": "string",
      "enum": ["healthy", "degraded", "unavailable"],
      "description": "Current operational status"
    },
    "input_schema": {
      "type": "object",
      "description": "JSON Schema for arm input validation"
    },
    "output_schema": {
      "type": "object",
      "description": "JSON Schema for arm output validation"
    },
    "metadata": {
      "type": "object",
      "properties": {
        "version": {"type": "string"},
        "technology": {"type": "string"},
        "model": {"type": "string"},
        "average_latency_ms": {"type": "number"},
        "max_concurrent_tasks": {"type": "integer"},
        "uptime_percentage": {"type": "number", "minimum": 0, "maximum": 100}
      }
    }
  }
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../api/schemas/task-contract.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../api/schemas/code-generation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../api/schemas/task-contract.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../api/schemas/code-generation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
