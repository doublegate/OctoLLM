<!DOCTYPE HTML>
<html lang="en" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Monitoring Runbook - OctoLLM Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Distributed AI Architecture for Offensive Security and Developer Tooling - Comprehensive technical documentation covering architecture, API, development, operations, and security.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OctoLLM Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/doublegate/OctoLLM" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/doublegate/OctoLLM/edit/main/docs/src/operations/monitoring-runbook.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="octollm-monitoring-runbook"><a class="header" href="#octollm-monitoring-runbook">OctoLLM Monitoring Runbook</a></h1>
<p><strong>Last Updated</strong>: 2025-11-12
<strong>Version</strong>: 1.0.0
<strong>Status</strong>: Active
<strong>Audience</strong>: Site Reliability Engineers, DevOps, On-Call Engineers</p>
<h2 id="table-of-contents"><a class="header" href="#table-of-contents">Table of Contents</a></h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#quick-access">Quick Access</a></li>
<li><a href="#grafana-usage">Grafana Usage</a></li>
<li><a href="#prometheus-usage">Prometheus Usage</a></li>
<li><a href="#loki-log-queries">Loki Log Queries</a></li>
<li><a href="#jaeger-trace-analysis">Jaeger Trace Analysis</a></li>
<li><a href="#alert-investigation">Alert Investigation</a></li>
<li><a href="#common-troubleshooting-scenarios">Common Troubleshooting Scenarios</a></li>
<li><a href="#escalation-procedures">Escalation Procedures</a></li>
<li><a href="#appendix">Appendix</a></li>
</ol>
<hr />
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>This runbook provides step-by-step procedures for using the OctoLLM monitoring stack to investigate issues, analyze performance, and respond to alerts.</p>
<h3 id="monitoring-stack-components"><a class="header" href="#monitoring-stack-components">Monitoring Stack Components</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Component</th><th>Purpose</th><th>Access URL</th><th>Port</th></tr></thead><tbody>
<tr><td><strong>Grafana</strong></td><td>Visualization and dashboards</td><td>https://grafana.octollm.dev</td><td>3000</td></tr>
<tr><td><strong>Prometheus</strong></td><td>Metrics collection and alerts</td><td>Port-forward only (prod)</td><td>9090</td></tr>
<tr><td><strong>Loki</strong></td><td>Log aggregation</td><td>Via Grafana datasource</td><td>3100</td></tr>
<tr><td><strong>Jaeger</strong></td><td>Distributed tracing</td><td>https://jaeger.octollm.dev</td><td>16686</td></tr>
<tr><td><strong>Alertmanager</strong></td><td>Alert routing</td><td>Port-forward only</td><td>9093</td></tr>
</tbody></table>
</div>
<h3 id="key-metrics"><a class="header" href="#key-metrics">Key Metrics</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Metric</th><th>Target</th><th>Critical Threshold</th></tr></thead><tbody>
<tr><td><strong>P99 Latency</strong></td><td>&lt; 30s</td><td>&gt; 30s</td></tr>
<tr><td><strong>Error Rate</strong></td><td>&lt; 1%</td><td>&gt; 10%</td></tr>
<tr><td><strong>CPU Usage</strong></td><td>&lt; 60%</td><td>&gt; 80%</td></tr>
<tr><td><strong>Memory Usage</strong></td><td>&lt; 70%</td><td>&gt; 85%</td></tr>
<tr><td><strong>Cache Hit Rate</strong></td><td>&gt; 60%</td><td>&lt; 40%</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="quick-access"><a class="header" href="#quick-access">Quick Access</a></h2>
<h3 id="access-grafana-production"><a class="header" href="#access-grafana-production">Access Grafana (Production)</a></h3>
<pre><code class="language-bash"># Via browser (recommended)
open https://grafana.octollm.dev

# Default credentials (change immediately!)
Username: admin
Password: (stored in Kubernetes secret)
</code></pre>
<h3 id="access-prometheus-port-forward"><a class="header" href="#access-prometheus-port-forward">Access Prometheus (Port-Forward)</a></h3>
<pre><code class="language-bash"># Production environment
kubectl port-forward -n octollm-monitoring svc/prometheus 9090:9090

# Access at http://localhost:9090
</code></pre>
<h3 id="access-jaeger-ui"><a class="header" href="#access-jaeger-ui">Access Jaeger UI</a></h3>
<pre><code class="language-bash"># Via browser
open https://jaeger.octollm.dev
</code></pre>
<h3 id="access-alertmanager-port-forward"><a class="header" href="#access-alertmanager-port-forward">Access Alertmanager (Port-Forward)</a></h3>
<pre><code class="language-bash">kubectl port-forward -n octollm-monitoring svc/alertmanager 9093:9093

# Access at http://localhost:9093
</code></pre>
<hr />
<h2 id="grafana-usage"><a class="header" href="#grafana-usage">Grafana Usage</a></h2>
<h3 id="available-dashboards"><a class="header" href="#available-dashboards">Available Dashboards</a></h3>
<p>OctoLLM provides 6 comprehensive dashboards:</p>
<ol>
<li>
<p><strong>GKE Cluster Overview</strong> (<code>octollm-gke-cluster</code>)</p>
<ul>
<li>Cluster-level CPU and memory usage</li>
<li>Node count and pod status</li>
<li>Resource utilization by namespace</li>
</ul>
</li>
<li>
<p><strong>Development Namespace</strong> (<code>octollm-namespace-dev</code>)</p>
<ul>
<li>Per-pod CPU and memory usage</li>
<li>Container restart counts</li>
<li>Request/limit utilization</li>
</ul>
</li>
<li>
<p><strong>Staging Namespace</strong> (<code>octollm-namespace-staging</code>)</p>
<ul>
<li>Similar to dev, focused on staging environment</li>
</ul>
</li>
<li>
<p><strong>Production Namespace</strong> (<code>octollm-namespace-prod</code>)</p>
<ul>
<li>Similar to dev, focused on production environment</li>
</ul>
</li>
<li>
<p><strong>Service Health</strong> (<code>octollm-service-health</code>)</p>
<ul>
<li>Request rates by service</li>
<li>Error rates (5xx responses)</li>
<li>P50/P95/P99 latency</li>
<li>Database and Redis connections</li>
</ul>
</li>
<li>
<p><strong>Logs Overview</strong> (<code>octollm-logs</code>)</p>
<ul>
<li>Log volume by service</li>
<li>Error rate visualization</li>
<li>Top 10 error messages</li>
<li>Live log stream</li>
</ul>
</li>
</ol>
<h3 id="how-to-navigate-dashboards"><a class="header" href="#how-to-navigate-dashboards">How to Navigate Dashboards</a></h3>
<ol>
<li><strong>Open Grafana</strong>: https://grafana.octollm.dev</li>
<li><strong>Navigate to Dashboards</strong>: Click the "Dashboards" icon (four squares) in the left sidebar</li>
<li><strong>Select OctoLLM Folder</strong>: All OctoLLM dashboards are in the "OctoLLM" folder</li>
<li><strong>Time Range</strong>: Use the time picker (top-right) to adjust the time range
<ul>
<li>Default: Last 1 hour</li>
<li>Recommended for troubleshooting: Last 6 hours or Last 24 hours</li>
</ul>
</li>
<li><strong>Refresh Rate</strong>: Set auto-refresh (top-right dropdown)
<ul>
<li>Recommended: 30s for live monitoring</li>
</ul>
</li>
</ol>
<h3 id="common-dashboard-tasks"><a class="header" href="#common-dashboard-tasks">Common Dashboard Tasks</a></h3>
<h4 id="check-overall-system-health"><a class="header" href="#check-overall-system-health">Check Overall System Health</a></h4>
<ol>
<li>Open <strong>GKE Cluster Overview</strong> dashboard</li>
<li>Check the gauge panels:
<ul>
<li>CPU Usage &lt; 80%? ✅ Healthy</li>
<li>Memory Usage &lt; 85%? ✅ Healthy</li>
<li>All pods Running? ✅ Healthy</li>
</ul>
</li>
<li>Scroll to "Resource Utilization" row</li>
<li>Check time series graphs for trends (spikes, sustained high usage)</li>
</ol>
<h4 id="investigate-high-error-rate"><a class="header" href="#investigate-high-error-rate">Investigate High Error Rate</a></h4>
<ol>
<li>Open <strong>Service Health</strong> dashboard</li>
<li>Locate "Error Rate by Service (5xx)" panel</li>
<li>Identify which service has elevated errors</li>
<li>Note the timestamp when errors started</li>
<li>Jump to <strong>Logs Overview</strong> dashboard</li>
<li>Filter logs by service and error level</li>
<li>Review "Top 10 Error Messages" for patterns</li>
</ol>
<h4 id="analyze-service-latency"><a class="header" href="#analyze-service-latency">Analyze Service Latency</a></h4>
<ol>
<li>Open <strong>Service Health</strong> dashboard</li>
<li>Scroll to "Latency Metrics" row</li>
<li>Compare P50, P95, and P99 latency panels</li>
<li>Identify services exceeding thresholds:
<ul>
<li>P95 &gt; 2s → Warning</li>
<li>P99 &gt; 10s → Warning</li>
<li>P99 &gt; 30s → Critical</li>
</ul>
</li>
<li>If latency is high, jump to Jaeger for trace analysis</li>
</ol>
<h4 id="monitor-database-connections"><a class="header" href="#monitor-database-connections">Monitor Database Connections</a></h4>
<ol>
<li>Open <strong>Service Health</strong> dashboard</li>
<li>Scroll to "Database Connections" row</li>
<li>Check PostgreSQL connection pool usage:
<ul>
<li>Active connections &lt; 10 (max 15) → Healthy</li>
<li>If active ≥ 10 → Investigate slow queries</li>
</ul>
</li>
<li>Check Redis connection pool:
<ul>
<li>Active + Idle &lt; 20 → Healthy</li>
</ul>
</li>
</ol>
<h4 id="view-namespace-specific-metrics"><a class="header" href="#view-namespace-specific-metrics">View Namespace-Specific Metrics</a></h4>
<ol>
<li>Open the appropriate namespace dashboard:
<ul>
<li><code>octollm-dev</code> for development</li>
<li><code>octollm-staging</code> for staging</li>
<li><code>octollm-prod</code> for production</li>
</ul>
</li>
<li>Review "Pod Status" panel:
<ul>
<li>All Running? ✅</li>
<li>Any Failed or Pending? Investigate</li>
</ul>
</li>
<li>Check "CPU Usage by Pod" and "Memory Usage by Pod"</li>
<li>Identify resource-hungry pods</li>
<li>Review "Container Restarts" panel:
<ul>
<li>0 restarts → Healthy</li>
<li>1-2 restarts → Monitor</li>
<li>3+ restarts → Investigate (likely CrashLoopBackOff)</li>
</ul>
</li>
</ol>
<h3 id="creating-custom-dashboards"><a class="header" href="#creating-custom-dashboards">Creating Custom Dashboards</a></h3>
<p>If you need to create a custom dashboard:</p>
<ol>
<li>Click "+" in the left sidebar</li>
<li>Select "Dashboard"</li>
<li>Click "Add new panel"</li>
<li>Select datasource: Prometheus, Loki, or Jaeger</li>
<li>Write PromQL, LogQL, or trace query</li>
<li>Configure visualization (time series, gauge, table, etc.)</li>
<li>Save dashboard with descriptive name and tags</li>
</ol>
<hr />
<h2 id="prometheus-usage"><a class="header" href="#prometheus-usage">Prometheus Usage</a></h2>
<h3 id="accessing-prometheus-ui"><a class="header" href="#accessing-prometheus-ui">Accessing Prometheus UI</a></h3>
<p>Prometheus is not exposed publicly for security. Use port-forwarding:</p>
<pre><code class="language-bash"># Forward Prometheus port
kubectl port-forward -n octollm-monitoring svc/prometheus 9090:9090

# Access at http://localhost:9090
</code></pre>
<h3 id="writing-promql-queries"><a class="header" href="#writing-promql-queries">Writing PromQL Queries</a></h3>
<h4 id="cpu-usage-query"><a class="header" href="#cpu-usage-query">CPU Usage Query</a></h4>
<pre><code class="language-promql"># Average CPU usage across all nodes
100 - (avg(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)

# CPU usage by specific service
sum(rate(container_cpu_usage_seconds_total{namespace="octollm-prod",pod=~"orchestrator.*"}[5m]))
</code></pre>
<h4 id="memory-usage-query"><a class="header" href="#memory-usage-query">Memory Usage Query</a></h4>
<pre><code class="language-promql"># Memory usage percentage
100 * (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes))

# Memory usage by pod
sum(container_memory_working_set_bytes{namespace="octollm-prod",pod=~"orchestrator.*"})
</code></pre>
<h4 id="request-rate-query"><a class="header" href="#request-rate-query">Request Rate Query</a></h4>
<pre><code class="language-promql"># Total request rate across all services
sum(rate(http_requests_total{namespace=~"octollm.*"}[5m]))

# Request rate by service
sum(rate(http_requests_total{namespace=~"octollm.*"}[5m])) by (job)
</code></pre>
<h4 id="error-rate-query"><a class="header" href="#error-rate-query">Error Rate Query</a></h4>
<pre><code class="language-promql"># Error rate (5xx responses) as percentage
(
  sum(rate(http_requests_total{status=~"5..",namespace=~"octollm.*"}[5m]))
  /
  sum(rate(http_requests_total{namespace=~"octollm.*"}[5m]))
) * 100
</code></pre>
<h4 id="latency-query-p95-p99"><a class="header" href="#latency-query-p95-p99">Latency Query (P95, P99)</a></h4>
<pre><code class="language-promql"># P95 latency by service
histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{namespace=~"octollm.*"}[5m])) by (job, le))

# P99 latency by service
histogram_quantile(0.99, sum(rate(http_request_duration_seconds_bucket{namespace=~"octollm.*"}[5m])) by (job, le))
</code></pre>
<h4 id="database-connection-pool-query"><a class="header" href="#database-connection-pool-query">Database Connection Pool Query</a></h4>
<pre><code class="language-promql"># Active database connections
sum(db_connections_active) by (job)

# Connection pool usage percentage
(db_connections_active / (db_connections_active + db_connections_idle)) * 100
</code></pre>
<h3 id="checking-alert-rules"><a class="header" href="#checking-alert-rules">Checking Alert Rules</a></h3>
<ol>
<li>In Prometheus UI, click "Alerts" in the top menu</li>
<li>View all configured alert rules</li>
<li>Check status:
<ul>
<li><strong>Inactive</strong> (green) → Rule condition not met, no alert</li>
<li><strong>Pending</strong> (yellow) → Rule condition met, waiting for <code>for</code> duration</li>
<li><strong>Firing</strong> (red) → Alert is active, sent to Alertmanager</li>
</ul>
</li>
<li>Click on an alert name to see:
<ul>
<li>Full alert query</li>
<li>Current value</li>
<li>Labels and annotations</li>
<li>Active alerts (if firing)</li>
</ul>
</li>
</ol>
<h3 id="checking-alertmanager-status"><a class="header" href="#checking-alertmanager-status">Checking Alertmanager Status</a></h3>
<p>Port-forward Alertmanager:</p>
<pre><code class="language-bash">kubectl port-forward -n octollm-monitoring svc/alertmanager 9093:9093
</code></pre>
<p>Access http://localhost:9093:</p>
<ol>
<li><strong>Alerts Tab</strong>: View all active alerts</li>
<li><strong>Silences Tab</strong>: View and create alert silences</li>
<li><strong>Status Tab</strong>: View Alertmanager configuration</li>
</ol>
<h3 id="creating-alert-silences"><a class="header" href="#creating-alert-silences">Creating Alert Silences</a></h3>
<p>If you need to temporarily suppress alerts (e.g., during maintenance):</p>
<ol>
<li>Access Alertmanager UI (port-forward)</li>
<li>Click "Silences" tab</li>
<li>Click "New Silence"</li>
<li>Fill in:
<ul>
<li><strong>Matchers</strong>: <code>alertname="HighCPUUsage"</code> OR <code>namespace="octollm-prod"</code></li>
<li><strong>Start</strong>: Now</li>
<li><strong>Duration</strong>: 1h, 4h, 24h, etc.</li>
<li><strong>Creator</strong>: Your name/email</li>
<li><strong>Comment</strong>: Reason for silence (e.g., "Planned maintenance")</li>
</ul>
</li>
<li>Click "Create"</li>
</ol>
<hr />
<h2 id="loki-log-queries"><a class="header" href="#loki-log-queries">Loki Log Queries</a></h2>
<h3 id="accessing-loki-via-grafana"><a class="header" href="#accessing-loki-via-grafana">Accessing Loki via Grafana</a></h3>
<ol>
<li>Open Grafana: https://grafana.octollm.dev</li>
<li>Click "Explore" (compass icon) in left sidebar</li>
<li>Select "Loki" datasource from dropdown (top-left)</li>
<li>Write LogQL queries</li>
</ol>
<h3 id="logql-syntax-basics"><a class="header" href="#logql-syntax-basics">LogQL Syntax Basics</a></h3>
<pre><code class="language-logql"># Basic log stream selector
{namespace="octollm-prod"}

# Filter by pod
{namespace="octollm-prod", pod=~"orchestrator.*"}

# Filter by log level
{namespace="octollm-prod", level="error"}

# Filter by service label
{service="orchestrator", level="error"}

# Combine multiple filters
{namespace="octollm-prod", service="orchestrator", level=~"error|warn"}
</code></pre>
<h3 id="common-log-queries"><a class="header" href="#common-log-queries">Common Log Queries</a></h3>
<h4 id="view-all-logs-from-a-service"><a class="header" href="#view-all-logs-from-a-service">View All Logs from a Service</a></h4>
<pre><code class="language-logql">{namespace="octollm-prod", service="orchestrator"}
</code></pre>
<h4 id="view-error-logs-only"><a class="header" href="#view-error-logs-only">View Error Logs Only</a></h4>
<pre><code class="language-logql">{namespace="octollm-prod", level="error"}
</code></pre>
<h4 id="search-for-specific-text-in-logs"><a class="header" href="#search-for-specific-text-in-logs">Search for Specific Text in Logs</a></h4>
<pre><code class="language-logql">{namespace="octollm-prod"} |= "database connection failed"
</code></pre>
<h4 id="filter-out-specific-text"><a class="header" href="#filter-out-specific-text">Filter Out Specific Text</a></h4>
<pre><code class="language-logql">{namespace="octollm-prod"} != "health check"
</code></pre>
<h4 id="parse-json-logs-and-filter-by-field"><a class="header" href="#parse-json-logs-and-filter-by-field">Parse JSON Logs and Filter by Field</a></h4>
<pre><code class="language-logql">{namespace="octollm-prod"} | json | status_code &gt;= 500
</code></pre>
<h4 id="count-error-rate-over-time"><a class="header" href="#count-error-rate-over-time">Count Error Rate Over Time</a></h4>
<pre><code class="language-logql">sum(rate({namespace="octollm-prod", level="error"}[1m])) by (service)
</code></pre>
<h4 id="top-10-error-messages"><a class="header" href="#top-10-error-messages">Top 10 Error Messages</a></h4>
<pre><code class="language-logql">topk(10, sum(count_over_time({namespace="octollm-prod", level="error"}[1h])) by (message))
</code></pre>
<h4 id="find-slow-requests-1s"><a class="header" href="#find-slow-requests-1s">Find Slow Requests (&gt;1s)</a></h4>
<pre><code class="language-logql">{namespace="octollm-prod"} | json | duration &gt; 1.0
</code></pre>
<h3 id="investigating-errors-with-logs"><a class="header" href="#investigating-errors-with-logs">Investigating Errors with Logs</a></h3>
<p><strong>Scenario</strong>: You receive an alert for high error rate in the <code>orchestrator</code> service.</p>
<ol>
<li><strong>Open Grafana Explore</strong></li>
<li><strong>Select Loki datasource</strong></li>
<li><strong>Query error logs</strong>:
<pre><code class="language-logql">{namespace="octollm-prod", service="orchestrator", level="error"}
</code></pre>
</li>
<li><strong>Adjust time range</strong> to when the alert started (e.g., last 1 hour)</li>
<li><strong>Review log messages</strong> for patterns:
<ul>
<li>Database connection errors?</li>
<li>LLM API errors (rate limiting, timeouts)?</li>
<li>Internal exceptions?</li>
</ul>
</li>
<li><strong>Identify the error message</strong> that appears most frequently</li>
<li><strong>Click on a log line</strong> to expand full details:
<ul>
<li>Trace ID (if available) → Jump to Jaeger</li>
<li>Request ID → Correlate with other logs</li>
<li>Stack trace → Identify code location</li>
</ul>
</li>
<li><strong>Check surrounding logs</strong> (context) by clicking "Show Context"</li>
</ol>
<hr />
<h2 id="jaeger-trace-analysis"><a class="header" href="#jaeger-trace-analysis">Jaeger Trace Analysis</a></h2>
<h3 id="accessing-jaeger-ui"><a class="header" href="#accessing-jaeger-ui">Accessing Jaeger UI</a></h3>
<pre><code class="language-bash"># Via browser
open https://jaeger.octollm.dev
</code></pre>
<h3 id="searching-for-traces"><a class="header" href="#searching-for-traces">Searching for Traces</a></h3>
<ol>
<li><strong>Service Dropdown</strong>: Select service (e.g., <code>orchestrator</code>)</li>
<li><strong>Operation Dropdown</strong>: Select operation (e.g., <code>/api/v1/tasks</code>)</li>
<li><strong>Tags</strong>: Add filters (e.g., <code>http.status_code=500</code>)</li>
<li><strong>Lookback</strong>: Select time range (e.g., last 1 hour)</li>
<li><strong>Click "Find Traces"</strong></li>
</ol>
<h3 id="understanding-trace-visualizations"><a class="header" href="#understanding-trace-visualizations">Understanding Trace Visualizations</a></h3>
<h4 id="trace-timeline-view"><a class="header" href="#trace-timeline-view">Trace Timeline View</a></h4>
<ul>
<li><strong>Horizontal bars</strong>: Each bar is a span (operation)</li>
<li><strong>Bar length</strong>: Duration of operation</li>
<li><strong>Vertical position</strong>: Parent-child relationships (nested = child span)</li>
<li><strong>Color</strong>: Service name (different services have different colors)</li>
</ul>
<h4 id="trace-details"><a class="header" href="#trace-details">Trace Details</a></h4>
<p>Click on a trace to view details:</p>
<ol>
<li>
<p><strong>Trace Summary</strong> (top):</p>
<ul>
<li>Total duration</li>
<li>Number of spans</li>
<li>Service count</li>
<li>Errors (if any)</li>
</ul>
</li>
<li>
<p><strong>Span List</strong> (left):</p>
<ul>
<li>Hierarchical view of all spans</li>
<li>Duration and start time for each span</li>
</ul>
</li>
<li>
<p><strong>Span Details</strong> (right, when clicked):</p>
<ul>
<li>Operation name</li>
<li>Tags (metadata): <code>http.method</code>, <code>http.url</code>, <code>http.status_code</code>, etc.</li>
<li>Logs (events within span)</li>
<li>Process info: Service name, instance ID</li>
</ul>
</li>
</ol>
<h3 id="common-trace-analysis-scenarios"><a class="header" href="#common-trace-analysis-scenarios">Common Trace Analysis Scenarios</a></h3>
<h4 id="investigate-high-latency"><a class="header" href="#investigate-high-latency">Investigate High Latency</a></h4>
<p><strong>Scenario</strong>: P99 latency for <code>/api/v1/tasks</code> exceeds 10 seconds.</p>
<ol>
<li>Open Jaeger UI</li>
<li>Select service: <code>orchestrator</code></li>
<li>Select operation: <code>/api/v1/tasks</code> (or <code>POST /api/v1/tasks</code>)</li>
<li>Set lookback: Last 1 hour</li>
<li>Sort by: Duration (descending)</li>
<li>Click on the slowest trace</li>
<li><strong>Analyze the trace</strong>:
<ul>
<li>Which span took the longest?</li>
<li>Database query? (look for spans with <code>db.*</code> tags)</li>
<li>LLM API call? (look for spans with <code>llm.*</code> tags)</li>
<li>Network call? (look for spans with <code>http.client.*</code> tags)</li>
</ul>
</li>
<li><strong>Drill down</strong> into the slow span:
<ul>
<li>Check tags for query parameters, request size, etc.</li>
<li>Check logs for error messages or warnings</li>
</ul>
</li>
<li><strong>Compare with fast traces</strong>:
<ul>
<li>Find a trace with normal latency</li>
<li>Compare span durations to identify the bottleneck</li>
</ul>
</li>
</ol>
<h4 id="find-errors-in-traces"><a class="header" href="#find-errors-in-traces">Find Errors in Traces</a></h4>
<ol>
<li>Open Jaeger UI</li>
<li>Select service</li>
<li>Add tag filter: <code>error=true</code></li>
<li>Click "Find Traces"</li>
<li>Click on a trace with errors (marked with red icon)</li>
<li><strong>Identify error span</strong>:
<ul>
<li>Look for red bar in timeline</li>
<li>Check span tags for <code>error.message</code> or <code>exception.type</code></li>
<li>Check span logs for stack trace</li>
</ul>
</li>
<li><strong>Understand error context</strong>:
<ul>
<li>What was the request?</li>
<li>Which service/operation failed?</li>
<li>Was it a client error (4xx) or server error (5xx)?</li>
</ul>
</li>
</ol>
<h4 id="trace-end-to-end-request-flow"><a class="header" href="#trace-end-to-end-request-flow">Trace End-to-End Request Flow</a></h4>
<p><strong>Scenario</strong>: Understand the complete flow of a request through all services.</p>
<ol>
<li>Open Jaeger UI</li>
<li>Select service: <code>orchestrator</code></li>
<li>Find a recent successful trace</li>
<li>Click on the trace</li>
<li><strong>Analyze the flow</strong>:
<ul>
<li><strong>Orchestrator</strong> receives request</li>
<li><strong>Reflex Layer</strong> preprocesses (fast, &lt;10ms)</li>
<li><strong>Planner Arm</strong> decomposes task</li>
<li><strong>Executor Arm</strong> performs actions</li>
<li><strong>Judge Arm</strong> validates output</li>
<li><strong>Orchestrator</strong> returns response</li>
</ul>
</li>
<li><strong>Check each span</strong>:
<ul>
<li>Duration (is it reasonable?)</li>
<li>Tags (what data was passed?)</li>
<li>Logs (were there any warnings?)</li>
</ul>
</li>
</ol>
<h3 id="correlating-traces-with-logs"><a class="header" href="#correlating-traces-with-logs">Correlating Traces with Logs</a></h3>
<p>If a trace has a <code>trace_id</code>, you can find related logs:</p>
<ol>
<li>Copy the <code>trace_id</code> from Jaeger span</li>
<li>Open Grafana Explore with Loki datasource</li>
<li>Query:
<pre><code class="language-logql">{namespace="octollm-prod"} | json | trace_id="&lt;PASTE_TRACE_ID&gt;"
</code></pre>
</li>
<li>View all logs related to that trace</li>
</ol>
<hr />
<h2 id="alert-investigation"><a class="header" href="#alert-investigation">Alert Investigation</a></h2>
<h3 id="alert-severity-levels"><a class="header" href="#alert-severity-levels">Alert Severity Levels</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Severity</th><th>Response Time</th><th>Notification</th><th>Escalation</th></tr></thead><tbody>
<tr><td><strong>Critical</strong></td><td>&lt; 15 minutes</td><td>PagerDuty + Slack</td><td>Immediate</td></tr>
<tr><td><strong>Warning</strong></td><td>&lt; 1 hour</td><td>Slack</td><td>After 4 hours</td></tr>
<tr><td><strong>Info</strong></td><td>Best effort</td><td>Slack (optional)</td><td>None</td></tr>
</tbody></table>
</div>
<h3 id="critical-alerts"><a class="header" href="#critical-alerts">Critical Alerts</a></h3>
<h4 id="podcrashloopbackoff"><a class="header" href="#podcrashloopbackoff">PodCrashLoopBackOff</a></h4>
<p><strong>Alert</strong>: Pod <code>&lt;namespace&gt;/&lt;pod&gt;</code> is crash looping (&gt;3 restarts in 10 minutes).</p>
<p><strong>Investigation Steps</strong>:</p>
<ol>
<li>
<p><strong>Check pod status</strong>:</p>
<pre><code class="language-bash">kubectl get pods -n &lt;namespace&gt;
kubectl describe pod &lt;pod-name&gt; -n &lt;namespace&gt;
</code></pre>
</li>
<li>
<p><strong>View pod logs</strong>:</p>
<pre><code class="language-bash">kubectl logs &lt;pod-name&gt; -n &lt;namespace&gt; --previous
</code></pre>
</li>
<li>
<p><strong>Common causes</strong>:</p>
<ul>
<li>Application startup failure (missing env vars, config errors)</li>
<li>OOMKilled (check <code>kubectl describe pod</code> for <code>Reason: OOMKilled</code>)</li>
<li>Liveness probe failure (misconfigured health check)</li>
</ul>
</li>
<li>
<p><strong>Resolution</strong>:</p>
<ul>
<li>If OOMKilled: Increase memory limit</li>
<li>If config error: Fix ConfigMap/Secret and restart</li>
<li>If code bug: Rollback deployment</li>
</ul>
</li>
</ol>
<h4 id="nodenotready"><a class="header" href="#nodenotready">NodeNotReady</a></h4>
<p><strong>Alert</strong>: Kubernetes node <code>&lt;node&gt;</code> is not ready for &gt;5 minutes.</p>
<p><strong>Investigation Steps</strong>:</p>
<ol>
<li>
<p><strong>Check node status</strong>:</p>
<pre><code class="language-bash">kubectl get nodes
kubectl describe node &lt;node-name&gt;
</code></pre>
</li>
<li>
<p><strong>Check node conditions</strong>:</p>
<ul>
<li><code>Ready=False</code> → Node is down</li>
<li><code>MemoryPressure=True</code> → Node is out of memory</li>
<li><code>DiskPressure=True</code> → Node is out of disk space</li>
</ul>
</li>
<li>
<p><strong>Check node logs</strong> (requires SSH access):</p>
<pre><code class="language-bash">gcloud compute ssh &lt;node-name&gt;
journalctl -u kubelet -n 100
</code></pre>
</li>
<li>
<p><strong>Resolution</strong>:</p>
<ul>
<li>If <code>MemoryPressure</code>: Drain node, evict pods, add more nodes</li>
<li>If <code>DiskPressure</code>: Clear disk space, expand volume</li>
<li>If node unresponsive: Replace node</li>
</ul>
</li>
</ol>
<h4 id="higherrorrate"><a class="header" href="#higherrorrate">HighErrorRate</a></h4>
<p><strong>Alert</strong>: Service <code>&lt;service&gt;</code> has error rate &gt;10% for 5 minutes.</p>
<p><strong>Investigation Steps</strong>:</p>
<ol>
<li>
<p><strong>Open Grafana Service Health dashboard</strong></p>
</li>
<li>
<p><strong>Identify the service with high errors</strong></p>
</li>
<li>
<p><strong>Check recent deployments</strong>:</p>
<pre><code class="language-bash">kubectl rollout history deployment/&lt;service&gt; -n &lt;namespace&gt;
</code></pre>
</li>
<li>
<p><strong>View error logs</strong>:</p>
<pre><code class="language-logql">{namespace="&lt;namespace&gt;", service="&lt;service&gt;", level="error"}
</code></pre>
</li>
<li>
<p><strong>Common causes</strong>:</p>
<ul>
<li>Recent deployment introduced bug</li>
<li>Downstream service failure (database, LLM API)</li>
<li>Configuration change</li>
</ul>
</li>
<li>
<p><strong>Resolution</strong>:</p>
<ul>
<li>If recent deployment: Rollback
<pre><code class="language-bash">kubectl rollout undo deployment/&lt;service&gt; -n &lt;namespace&gt;
</code></pre>
</li>
<li>If downstream failure: Check dependent services</li>
<li>If config issue: Fix ConfigMap/Secret</li>
</ul>
</li>
</ol>
<h4 id="servicedown"><a class="header" href="#servicedown">ServiceDown</a></h4>
<p><strong>Alert</strong>: Service <code>&lt;service&gt;</code> is unreachable for &gt;2 minutes.</p>
<p><strong>Investigation Steps</strong>:</p>
<ol>
<li>
<p><strong>Check pod status</strong>:</p>
<pre><code class="language-bash">kubectl get pods -n &lt;namespace&gt; -l app=&lt;service&gt;
</code></pre>
</li>
<li>
<p><strong>Check service endpoints</strong>:</p>
<pre><code class="language-bash">kubectl get endpoints &lt;service&gt; -n &lt;namespace&gt;
</code></pre>
</li>
<li>
<p><strong>Check recent events</strong>:</p>
<pre><code class="language-bash">kubectl get events -n &lt;namespace&gt; --sort-by='.lastTimestamp'
</code></pre>
</li>
<li>
<p><strong>Resolution</strong>:</p>
<ul>
<li>If no pods running: Check deployment spec, resource quotas</li>
<li>If pods running but unhealthy: Check liveness/readiness probes</li>
<li>If service misconfigured: Fix service selector</li>
</ul>
</li>
</ol>
<h4 id="databaseconnectionpoolexhausted"><a class="header" href="#databaseconnectionpoolexhausted">DatabaseConnectionPoolExhausted</a></h4>
<p><strong>Alert</strong>: Database connection pool &gt;95% utilization for 5 minutes.</p>
<p><strong>Investigation Steps</strong>:</p>
<ol>
<li>
<p><strong>Check active connections in Grafana</strong></p>
</li>
<li>
<p><strong>Identify which service is using most connections</strong></p>
</li>
<li>
<p><strong>Check for connection leaks</strong>:</p>
<ul>
<li>Are connections being properly closed?</li>
<li>Are there long-running queries?</li>
</ul>
</li>
<li>
<p><strong>View slow queries</strong> (PostgreSQL):</p>
<pre><code class="language-sql">SELECT pid, now() - query_start AS duration, query
FROM pg_stat_activity
WHERE state = 'active'
ORDER BY duration DESC;
</code></pre>
</li>
<li>
<p><strong>Resolution</strong>:</p>
<ul>
<li>Kill slow/stuck queries</li>
<li>Increase connection pool size (temporary)</li>
<li>Fix connection leak in code</li>
</ul>
</li>
</ol>
<h3 id="warning-alerts"><a class="header" href="#warning-alerts">Warning Alerts</a></h3>
<h4 id="highnodecpuusage"><a class="header" href="#highnodecpuusage">HighNodeCPUUsage</a></h4>
<p><strong>Alert</strong>: Node CPU usage &gt;80% for 10 minutes.</p>
<p><strong>Investigation Steps</strong>:</p>
<ol>
<li>
<p><strong>Identify resource-hungry pods</strong>:</p>
<pre><code class="language-bash">kubectl top pods -n &lt;namespace&gt; --sort-by=cpu
</code></pre>
</li>
<li>
<p><strong>Check for CPU throttling</strong>:</p>
<pre><code class="language-promql">rate(container_cpu_cfs_throttled_seconds_total{namespace="&lt;namespace&gt;"}[5m])
</code></pre>
</li>
<li>
<p><strong>Resolution</strong>:</p>
<ul>
<li>Scale down non-critical workloads</li>
<li>Increase CPU limits for pods</li>
<li>Add more cluster nodes (HorizontalPodAutoscaler)</li>
</ul>
</li>
</ol>
<h4 id="highnodememoryusage"><a class="header" href="#highnodememoryusage">HighNodeMemoryUsage</a></h4>
<p><strong>Alert</strong>: Node memory usage &gt;85% for 10 minutes.</p>
<p><strong>Investigation Steps</strong>:</p>
<ol>
<li>
<p><strong>Identify memory-hungry pods</strong>:</p>
<pre><code class="language-bash">kubectl top pods -n &lt;namespace&gt; --sort-by=memory
</code></pre>
</li>
<li>
<p><strong>Check for memory leaks</strong>:</p>
<ul>
<li>Review application logs for OOM warnings</li>
<li>Check memory usage trend (gradual increase = leak)</li>
</ul>
</li>
<li>
<p><strong>Resolution</strong>:</p>
<ul>
<li>Restart pods with memory leaks</li>
<li>Increase memory limits</li>
<li>Add more cluster nodes</li>
</ul>
</li>
</ol>
<hr />
<h2 id="common-troubleshooting-scenarios"><a class="header" href="#common-troubleshooting-scenarios">Common Troubleshooting Scenarios</a></h2>
<h3 id="scenario-1-sudden-spike-in-latency"><a class="header" href="#scenario-1-sudden-spike-in-latency">Scenario 1: Sudden Spike in Latency</a></h3>
<p><strong>Symptoms</strong>:</p>
<ul>
<li>P99 latency increased from 5s to 30s</li>
<li>No increase in error rate</li>
<li>Request rate unchanged</li>
</ul>
<p><strong>Investigation</strong>:</p>
<ol>
<li><strong>Check Grafana Service Health dashboard</strong>
<ul>
<li>Identify which service has high latency</li>
</ul>
</li>
<li><strong>Open Jaeger, find slow traces</strong>
<ul>
<li>Identify bottleneck span (database query, LLM call, etc.)</li>
</ul>
</li>
<li><strong>Check database performance</strong>:
<pre><code class="language-promql">rate(db_query_duration_seconds_sum[5m]) / rate(db_query_duration_seconds_count[5m])
</code></pre>
</li>
<li><strong>Check LLM API latency</strong>:
<pre><code class="language-logql">{namespace="octollm-prod"} | json | llm_duration_seconds &gt; 10
</code></pre>
</li>
</ol>
<p><strong>Resolution</strong>:</p>
<ul>
<li>If database slow: Check for missing indexes, slow queries</li>
<li>If LLM slow: Check provider status, implement caching</li>
</ul>
<h3 id="scenario-2-service-keeps-restarting"><a class="header" href="#scenario-2-service-keeps-restarting">Scenario 2: Service Keeps Restarting</a></h3>
<p><strong>Symptoms</strong>:</p>
<ul>
<li>Pod restart count increasing</li>
<li>No obvious errors in logs</li>
<li>Service health checks failing</li>
</ul>
<p><strong>Investigation</strong>:</p>
<ol>
<li>
<p><strong>Check pod events</strong>:</p>
<pre><code class="language-bash">kubectl describe pod &lt;pod-name&gt; -n &lt;namespace&gt;
</code></pre>
</li>
<li>
<p><strong>Check for OOMKilled</strong>:</p>
<ul>
<li>Look for <code>Reason: OOMKilled</code> in pod status</li>
<li>Memory limit too low</li>
</ul>
</li>
<li>
<p><strong>Check liveness probe</strong>:</p>
<ul>
<li>Is probe misconfigured (timeout too short)?</li>
<li>Is health endpoint actually healthy?</li>
</ul>
</li>
<li>
<p><strong>View logs from previous container</strong>:</p>
<pre><code class="language-bash">kubectl logs &lt;pod-name&gt; -n &lt;namespace&gt; --previous
</code></pre>
</li>
</ol>
<p><strong>Resolution</strong>:</p>
<ul>
<li>If OOMKilled: Increase memory limit</li>
<li>If liveness probe: Adjust probe settings or fix health endpoint</li>
<li>If application crash: Fix code bug</li>
</ul>
<h3 id="scenario-3-certificate-expiration"><a class="header" href="#scenario-3-certificate-expiration">Scenario 3: Certificate Expiration</a></h3>
<p><strong>Symptoms</strong>:</p>
<ul>
<li>Alert: Certificate expiring in &lt;7 days</li>
<li>HTTPS services may be affected</li>
</ul>
<p><strong>Investigation</strong>:</p>
<ol>
<li>
<p><strong>Check certificate expiration</strong>:</p>
<pre><code class="language-bash">kubectl get certificate -n &lt;namespace&gt;
</code></pre>
</li>
<li>
<p><strong>Check cert-manager logs</strong>:</p>
<pre><code class="language-bash">kubectl logs -n cert-manager deployment/cert-manager
</code></pre>
</li>
<li>
<p><strong>Check certificate renewal attempts</strong>:</p>
<pre><code class="language-bash">kubectl describe certificate &lt;cert-name&gt; -n &lt;namespace&gt;
</code></pre>
</li>
</ol>
<p><strong>Resolution</strong>:</p>
<ul>
<li>If cert-manager renewal failed: Check DNS, ACME challenge logs</li>
<li>If manual renewal needed:
<pre><code class="language-bash">kubectl delete certificate &lt;cert-name&gt; -n &lt;namespace&gt;
# cert-manager will automatically create new certificate
</code></pre>
</li>
</ul>
<hr />
<h2 id="escalation-procedures"><a class="header" href="#escalation-procedures">Escalation Procedures</a></h2>
<h3 id="when-to-escalate"><a class="header" href="#when-to-escalate">When to Escalate</a></h3>
<p>Escalate to the next level if:</p>
<ol>
<li><strong>Critical alert</strong> not resolved within <strong>15 minutes</strong></li>
<li><strong>Multiple critical alerts</strong> firing simultaneously</li>
<li><strong>Data loss</strong> or <strong>security incident</strong> suspected</li>
<li><strong>Root cause</strong> unclear after 30 minutes of investigation</li>
<li><strong>Infrastructure issue</strong> beyond application scope (GCP outage, network failure)</li>
</ol>
<h3 id="escalation-contacts"><a class="header" href="#escalation-contacts">Escalation Contacts</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Level</th><th>Contact</th><th>Response Time</th><th>Scope</th></tr></thead><tbody>
<tr><td><strong>L1</strong></td><td>On-Call Engineer</td><td>&lt; 15 min</td><td>Application-level issues</td></tr>
<tr><td><strong>L2</strong></td><td>Senior SRE</td><td>&lt; 30 min</td><td>Complex infrastructure issues</td></tr>
<tr><td><strong>L3</strong></td><td>Platform Lead</td><td>&lt; 1 hour</td><td>Critical system-wide incidents</td></tr>
<tr><td><strong>L4</strong></td><td>CTO</td><td>&lt; 2 hours</td><td>Business-critical outages</td></tr>
</tbody></table>
</div>
<h3 id="escalation-process"><a class="header" href="#escalation-process">Escalation Process</a></h3>
<ol>
<li>
<p><strong>Gather information</strong>:</p>
<ul>
<li>Alert name and severity</li>
<li>Time alert started</li>
<li>Services affected</li>
<li>Investigation steps taken so far</li>
<li>Current hypothesis</li>
</ul>
</li>
<li>
<p><strong>Contact next level</strong>:</p>
<ul>
<li>PagerDuty (for critical alerts)</li>
<li>Slack #incidents channel</li>
<li>Phone (for P0/P1 incidents)</li>
</ul>
</li>
<li>
<p><strong>Provide context</strong>:</p>
<ul>
<li>Share Grafana dashboard links</li>
<li>Share relevant logs/traces</li>
<li>Describe impact (users affected, data loss risk)</li>
</ul>
</li>
<li>
<p><strong>Continue investigation</strong> while waiting for response</p>
</li>
<li>
<p><strong>Update incident channel</strong> with progress</p>
</li>
</ol>
<hr />
<h2 id="appendix"><a class="header" href="#appendix">Appendix</a></h2>
<h3 id="useful-kubectl-commands"><a class="header" href="#useful-kubectl-commands">Useful kubectl Commands</a></h3>
<pre><code class="language-bash"># Get all pods in namespace
kubectl get pods -n octollm-prod

# Describe pod (detailed info)
kubectl describe pod &lt;pod-name&gt; -n octollm-prod

# View pod logs
kubectl logs &lt;pod-name&gt; -n octollm-prod

# View logs from previous container (if restarted)
kubectl logs &lt;pod-name&gt; -n octollm-prod --previous

# Follow logs in real-time
kubectl logs -f &lt;pod-name&gt; -n octollm-prod

# Execute command in pod
kubectl exec -it &lt;pod-name&gt; -n octollm-prod -- /bin/bash

# Port-forward to pod
kubectl port-forward -n octollm-prod &lt;pod-name&gt; 8000:8000

# Get events in namespace
kubectl get events -n octollm-prod --sort-by='.lastTimestamp'

# Get top pods by CPU/memory
kubectl top pods -n octollm-prod --sort-by=cpu
kubectl top pods -n octollm-prod --sort-by=memory

# Rollback deployment
kubectl rollout undo deployment/&lt;service&gt; -n octollm-prod

# Scale deployment
kubectl scale deployment/&lt;service&gt; -n octollm-prod --replicas=5

# Delete pod (will be recreated by deployment)
kubectl delete pod &lt;pod-name&gt; -n octollm-prod
</code></pre>
<h3 id="useful-promql-aggregations"><a class="header" href="#useful-promql-aggregations">Useful PromQL Aggregations</a></h3>
<pre><code class="language-promql"># Sum
sum(metric_name) by (label)

# Average
avg(metric_name) by (label)

# Count
count(metric_name) by (label)

# Min/Max
min(metric_name) by (label)
max(metric_name) by (label)

# Top K
topk(10, metric_name)

# Bottom K
bottomk(10, metric_name)

# Rate (per-second)
rate(metric_name[5m])

# Increase (total over time)
increase(metric_name[1h])

# Histogram quantile (P95, P99)
histogram_quantile(0.95, rate(metric_bucket[5m]))
</code></pre>
<h3 id="useful-logql-patterns"><a class="header" href="#useful-logql-patterns">Useful LogQL Patterns</a></h3>
<pre><code class="language-logql"># Stream selector
{label="value"}

# Multiple labels
{label1="value1", label2="value2"}

# Regex match
{label=~"regex"}

# Negative regex
{label!~"regex"}

# Contains text
{label="value"} |= "search text"

# Doesn't contain text
{label="value"} != "exclude text"

# Regex filter
{label="value"} |~ "regex"

# JSON parsing
{label="value"} | json

# Rate (logs per second)
rate({label="value"}[1m])

# Count over time
count_over_time({label="value"}[1h])

# Aggregations
sum(count_over_time({label="value"}[1h])) by (service)
</code></pre>
<h3 id="gcp-commands"><a class="header" href="#gcp-commands">GCP Commands</a></h3>
<pre><code class="language-bash"># List GKE clusters
gcloud container clusters list

# Get cluster credentials
gcloud container clusters get-credentials octollm-prod --region us-central1

# List nodes
gcloud compute instances list

# SSH to node
gcloud compute ssh &lt;node-name&gt;

# View GCS buckets (for Loki logs)
gsutil ls gs://octollm-loki-logs

# View bucket contents
gsutil ls -r gs://octollm-loki-logs

# Check Cloud SQL instances
gcloud sql instances list

# Check Redis instances
gcloud redis instances list --region us-central1
</code></pre>
<hr />
<p><strong>End of Runbook</strong></p>
<p>For additional assistance, contact:</p>
<ul>
<li>Slack: #octollm-sre</li>
<li>PagerDuty: octollm-oncall</li>
<li>Email: sre@octollm.dev</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../operations/monitoring-alerting.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../operations/alert-response-procedures.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../operations/monitoring-alerting.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../operations/alert-response-procedures.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
